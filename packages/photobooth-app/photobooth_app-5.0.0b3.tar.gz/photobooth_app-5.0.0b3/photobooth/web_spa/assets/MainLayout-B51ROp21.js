import{d as b,u as C,a as k,b as M,c as A,e as y,o as B,w as v,_ as $,f,g as T,h as N,i as Q,j as R,r as L,k as d,l as m,m as _,Q as E,n as P,p as q,t as x,q as S}from"./index-DFt1AGAb.js";import{Q as O}from"./QPageSticky-DxQ9EuIF.js";import{Q as j,a as I}from"./QLayout-DM2ag1m_.js";const V=b({__name:"RouteAfterTimeout",props:{route:{type:String,required:!0},timeoutMs:{type:Number,required:!0},warningMessage:{type:String,default:"Auto-starting slideshow... Click anywhere to stay on this page."},warningTimeMs:{type:Number,default:1e4}},setup(a,{expose:s}){s();const o=C(),t=k(),e=a,{idle:r,lastActive:i}=M(e.timeoutMs),c=A({interval:1e3}),n=y(()=>e.timeoutMs-(c.value-i.value)),g=y(()=>e.warningTimeMs>n.value);let u=null;function w(){u=o.notify({progress:!0,message:e.warningMessage,type:"info",multiLine:!0,timeout:n.value,icon:"sym_o_slideshow"})}function l(){u&&u()}B(()=>{l()}),v(g,p=>{p?w():l()}),v(r,p=>{p&&(l(),t.push({path:e.route}))});const h={$q:o,router:t,props:e,idle:r,lastActive:i,now:c,remainingTime:n,showWarning:g,get warningPopup(){return u},set warningPopup(p){u=p},showNotification:w,hideNotification:l};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}});function W(a,s,o,t,e,r){return f(),T("div")}const D=$(V,[["render",W],["__file","RouteAfterTimeout.vue"]]),F=b({__name:"MainLayout",setup(a,{expose:s}){s();const o=N(),t=Q(),e=k(),r=R();o.$subscribe((c,n)=>{n.state=="counting"&&r.path!="/"&&(console.log("counting state received, pushing to index page to countdown"),e.push("/")),n.state=="present_capture"&&e.push({name:"itempresenter",params:{id:o.last_captured_mediaitem.id}}),n.state=="approve_capture"&&n.ask_user_for_approval&&e.push({path:"/itemapproval"})});const i={stateStore:o,configurationStore:t,router:e,route:r,RouteAfterTimeout:D};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}});function H(a,s,o,t,e,r){const i=L("router-view");return f(),d(I,{id:"main-layout",view:"hHh lpR fFf"},{default:m(()=>[_(j,null,{default:m(()=>[_(i),t.route.path!="/"?(f(),d(O,{key:0,position:"top-left",class:"q-ma-lg",style:{}},{default:m(()=>[_(E,{id:"layout-button-back",color:"primary",rounded:"","no-caps":"",onClick:s[0]||(s[0]=c=>a.$router.back()),class:"action-button"},{default:m(()=>[_(P,{left:"",name:"sym_o_arrow_back_ios_new"}),q("div",null,x(a.$t("BTN_LABEL_BACK")),1)]),_:1})]),_:1})):S("",!0),t.configurationStore.getConfigElement("uisettings.enable_automatic_slideshow",!1)?(f(),d(t.RouteAfterTimeout,{key:1,route:"/slideshow/random","timeout-ms":t.configurationStore.getConfigElement("uisettings.show_automatic_slideshow_timeout",300)*1e3,"warning-message":a.$t("MSG_WARN_BEFORE_AUTO_SLIDESHOW")},null,8,["timeout-ms","warning-message"])):S("",!0)]),_:1})]),_:1})}const z=$(F,[["render",H],["__file","MainLayout.vue"]]);export{z as default};
