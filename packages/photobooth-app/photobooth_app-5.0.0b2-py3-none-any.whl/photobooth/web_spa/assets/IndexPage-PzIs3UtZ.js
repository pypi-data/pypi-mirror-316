import{s as G,v as R,x as H,y as j,d as L,z as I,e as d,A as K,o as W,_ as Q,B as N,C as P,f as i,g as m,p as _,m as u,l as g,D as X,t as M,E as S,F as J,G as U,k as v,n as F,q as c,H as T,Q as E,h as Y,i as Z,a as $,I as ee,J as D,K as te}from"./index-DFt1AGAb.js";import{Q as x}from"./QPageSticky-DxQ9EuIF.js";import{Q as ne}from"./QPage-BSM4c28G.js";import{Q as ie}from"./QCircularProgress-DSqVnq0k.js";import"./format-CJebrXOQ.js";const oe='<circle cx="12.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="0s" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="52.5" r="12.5" fill-opacity=".5"><animate attributeName="fill-opacity" begin="100ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="300ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="600ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="800ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="400ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="700ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="500ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="200ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',ae=G({name:"QSpinnerGrid",props:R,setup(s){const{cSize:n,classes:t}=H(s);return()=>j("svg",{class:t.value,fill:"currentColor",width:n.value,height:n.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg",innerHTML:oe})}}),re='<g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle></g>',se=G({name:"QSpinnerPuff",props:R,setup(s){const{cSize:n,classes:t}=H(s);return()=>j("svg",{class:t.value,stroke:"currentColor",width:n.value,height:n.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg",innerHTML:re})}}),ce=L({__name:"CountdownTimer",props:{duration:{},messageDuration:{default:.5},messageText:{default:"ðŸ˜ƒ"}},setup(s,{expose:n}){n();let t;const e=I(0),r=I(0),o=s,a=d(()=>e.value>0),p=d(()=>e.value>0),b=d(()=>e.value<=o.messageDuration);K(()=>{h()}),W(()=>{C()});const C=()=>{clearInterval(t),e.value=0},h=()=>{r.value=o.duration,e.value=r.value,console.log(`starting timer, duration=${r.value}`),t=window.setInterval(()=>{e.value-=.05,e.value<=0&&clearInterval(t)},50)},y={get intervalTimerId(){return t},set intervalTimerId(B){t=B},remainingSeconds:e,startDuration:r,props:o,showBox:a,showCountdown:p,showMessage:b,abortTimer:C,startTimer:h};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),le={id:"countdown-timer-container",class:"flex flex-center",style:{width:"70vw",height:"70vh"}},ue=["innerHTML"],de={style:{height:"100%"}};function me(s,n,t,e,r,o){return N((i(),m("div",le,[N(_("div",{id:"countdown-timer-message",style:{position:"absolute","font-size":"150px"},innerHTML:t.messageText},null,8,ue),[[P,e.showMessage]]),_("div",de,[N(u(ie,{"show-value":!e.showMessage,style:{width:"100%",height:"100%"},value:e.remainingSeconds,min:0,max:e.startDuration,reverse:"","animation-speed":"100","font-size":"0.5em",size:"70vh",color:"primary",class:"text-secondary"},{default:g(()=>[X(M(parseFloat(e.remainingSeconds.toFixed(0))),1)]),_:1},8,["show-value","value","max"]),[[P,e.showCountdown]])])],512)),[[P,e.showBox]])}const ge=Q(ce,[["render",me],["__file","CountdownTimer.vue"]]),_e=L({__name:"FrontpageTriggerButtons",props:{triggers:{}},emits:["triggerAction"],setup(s,{expose:n,emit:t}){n();const e=t;function r(a,p){e("triggerAction",a,p)}const o={emit:e,triggerButtonClick:r,get isEmpty(){return S.isEmpty}};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),pe={class:"row q-gutter-md action-buttons"},fe={style:{"white-space":"nowrap"},class:"gt-sm"};function ve(s,n,t,e,r,o){return i(),m("div",pe,[(i(!0),m(J,null,U(t.triggers,(a,p)=>(i(),m("div",{key:p},[a.show_button&&!(e.isEmpty(a.title)&&e.isEmpty(a.icon))?(i(),v(E,{key:0,stack:"",color:"primary","no-caps":"",rounded:"",class:T(["action-button col-auto",["action-button-"+p]]),onClick:b=>e.triggerButtonClick(a.action,a.config_index)},{default:g(()=>[e.isEmpty(a.icon)?c("",!0):(i(),v(F,{key:0,name:`sym_o_${a.icon}`},null,8,["name"])),_("div",fe,M(a.title),1)]),_:2},1032,["class","onClick"])):c("",!0)]))),128))])}const he=Q(_e,[["render",ve],["__file","FrontpageTriggerButtons.vue"]]),ye=L({__name:"IndexPage",setup(s,{expose:n}){n();const t=Y(),e=Z(),r=$(),o=I(0);ee(o,()=>{o.value>=5&&r.push("/admin"),o.value=0},{debounce:500});const a=d(()=>{const l=[];return["actions.image","actions.collage","actions.animation","actions.video","actions.multicamera","printer.print"].forEach(k=>{e.getConfigElement(k,[]).forEach((w,A)=>{const O={action:k.replace(".","/"),config_index:A,show_button:S.get(w,"trigger.ui_trigger.show_button",!1),title:S.get(w,"trigger.ui_trigger.title",""),icon:S.get(w,"trigger.ui_trigger.icon","")};l.push(O)})}),console.log(l),l}),p=d(()=>{const l=t.state=="capture";return t.state=="captures_completed"||l&&!y.value}),b=d(()=>t.state=="record"),C=d(()=>e.getConfigElement("uisettings.livestream_mirror_effect")),h=d(()=>e.getConfigElement("uisettings.admin_button_invisible",!1)),y=d(()=>{const l=t.state=="counting",f=t.state=="capture";return t.duration&&t.duration>0&&l||f}),B=d(()=>{const l=e.getConfigElement("uisettings.enable_livestream_when_idle",!0),f=e.getConfigElement("uisettings.enable_livestream_when_active",!0),k=!t.state||t.state=="finished",q=t.state=="record",w=t.state=="counting",A=t.state=="capture";return k&&l||(w||A)&&f||q}),V=d(()=>!t.state||t.state=="finished"),z={stateStore:t,configurationStore:e,router:r,btnAdminClickCounter:o,triggerButtons:a,showProcessing:p,showRecording:b,livestreamMirror:C,adminButtonInvisible:h,showCountdownCounting:y,showPreview:B,showFrontpage:V,onBtnAdminClick:()=>{h.value?o.value++:r.push("/admin")},invokeAction:(l,f)=>{D(`/api/${l}/${f}`)},stopRecordingVideo:()=>{D("/api/actions/stop")},CountdownTimer:ge,FrontpageTriggerButtons:he};return Object.defineProperty(z,"__isScriptSetup",{enumerable:!1,value:!0}),z}}),we={key:0,class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},be={key:1,id:"frontpage-countdown",class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},Ce=["innerHTML"],ke={key:0},xe={key:0},Se={class:"q-gutter-md"},Te={class:"gt-sm"},Ee={key:0},Me={class:"q-gutter-md"},Be={class:"gt-sm"};function Ae(s,n,t,e,r,o){return i(),v(ne,{id:"index-page",class:"q-pa-none column full-height"},{default:g(()=>[_("div",{id:"preview-stream-wrapper",class:T({mirroreffect:e.livestreamMirror})},[e.showPreview?(i(),m("div",{key:0,id:"preview-stream",style:{"background-image":"url('/api/aquisition/stream.mjpg')"},class:T(["full-width column justify-center content-center",{countdowncounting:e.showCountdownCounting}])},null,2)):c("",!0)],2),e.showProcessing?(i(),m("div",we,[u(ae,{size:"20em"})])):c("",!0),e.showCountdownCounting?(i(),m("div",be,[u(e.CountdownTimer,{ref:"countdowntimer",duration:e.stateStore.duration,"message-duration":e.configurationStore.getConfigElement("uisettings.TAKEPIC_MSG_TIME"),"message-text":e.configurationStore.getConfigElement("uisettings.TAKEPIC_MSG_TEXT")},null,8,["duration","message-duration","message-text"])])):c("",!0),e.showFrontpage?(i(),m("div",{key:2,id:"frontpage_text",innerHTML:e.configurationStore.getConfigElement("uisettings.FRONTPAGE_TEXT")},null,8,Ce)):c("",!0),u(x,{position:"bottom",class:"q-mb-lg"},{default:g(()=>[e.showFrontpage?(i(),m("div",ke,[u(e.FrontpageTriggerButtons,{triggers:e.triggerButtons,onTriggerAction:e.invokeAction},null,8,["triggers"])])):c("",!0)]),_:1}),u(x,{position:"top-left",class:"q-ma-lg"},{default:g(()=>[e.showFrontpage?(i(),m("div",xe,[_("div",Se,[e.configurationStore.getConfigElement("uisettings.show_gallery_on_frontpage")?(i(),v(E,{key:0,id:"frontpage-button-to-gallery",color:"primary","no-caps":"",rounded:"",to:"/gallery",class:"action-button",style:te(e.configurationStore.getConfigElement("uisettings.gallery_button_style"))},{default:g(()=>[u(F,{left:"",name:"sym_o_photo_library"}),_("div",Te,M(s.$t("BTN_LABEL_MAINPAGE_TO_GALLERY")),1)]),_:1},8,["style"])):c("",!0)])])):c("",!0)]),_:1}),u(x,{position:"top-right",class:"q-ma-lg"},{default:g(()=>[e.showFrontpage?(i(),m("div",Ee,[_("div",Me,[e.configurationStore.getConfigElement("uisettings.show_admin_on_frontpage")?(i(),v(E,{key:0,id:"frontpage-button-to-admin",rounded:"",color:"transparent","no-caps":"",class:T(["action-button action-button-admin",{"action-button-admin-invisible":e.adminButtonInvisible}]),onClick:e.onBtnAdminClick},{default:g(()=>[u(F,{left:"",name:"sym_o_admin_panel_settings"}),_("div",Be,M(s.$t("BTN_LABEL_MAINPAGE_TO_ADMIN")),1)]),_:1},8,["class"])):c("",!0)])])):c("",!0)]),_:1}),e.showRecording?(i(),v(x,{key:3,id:"frontpage-indicator-recording",position:"top",offset:[0,25],align:"center"},{default:g(()=>[u(se,{color:"red",size:"10em"}),n[1]||(n[1]=_("br",null,null,-1)),u(E,{flat:"",color:"red",label:"Stop recording",onClick:n[0]||(n[0]=a=>e.stopRecordingVideo())})]),_:1})):c("",!0)]),_:1})}const De=Q(ye,[["render",Ae],["__file","IndexPage.vue"]]);export{De as default};
