Metadata-Version: 2.1
Name: graphrag-more
Version: 1.0.1
Summary: åŸºäºå¾®è½¯GraphRAGï¼Œæ”¯æŒä½¿ç”¨ç™¾åº¦åƒå¸†ã€é˜¿é‡Œé€šä¹‰ã€Ollamaç­‰æ¨¡å‹
Home-page: https://github.com/guoyao/graphrag-more
License: MIT
Author: Guoyao Wu
Author-email: guoyao.me@gmail.com
Requires-Python: >=3.10,<3.13
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Dist: aiofiles (>=24.1.0,<25.0.0)
Requires-Dist: azure-identity (>=1.19.0,<2.0.0)
Requires-Dist: azure-search-documents (>=11.5.2,<12.0.0)
Requires-Dist: azure-storage-blob (>=12.24.0,<13.0.0)
Requires-Dist: dashscope (>=1.20.14,<2.0.0)
Requires-Dist: datashaper (>=0.0.49,<0.0.50)
Requires-Dist: devtools (>=0.12.2,<0.13.0)
Requires-Dist: environs (>=11.0.0,<12.0.0)
Requires-Dist: fnllm (>=0.0.10,<0.0.11)
Requires-Dist: future (>=1.0.0,<2.0.0)
Requires-Dist: graspologic (>=3.4.1,<4.0.0)
Requires-Dist: httpx (>=0.27.2,<0.28.0)
Requires-Dist: json-repair (>=0.30.3,<0.31.0)
Requires-Dist: lancedb (>=0.17.0,<0.18.0)
Requires-Dist: langchain-community (>=0.2.19,<0.3.0)
Requires-Dist: langchain-core (>=0.2.43,<0.3.0)
Requires-Dist: langchain-ollama (>=0.1.3,<0.2.0)
Requires-Dist: matplotlib (>=3.9.3,<4.0.0)
Requires-Dist: networkx (>=3.4.2,<4.0.0)
Requires-Dist: nltk (==3.9.1)
Requires-Dist: numpy (>=1.25.2,<2.0.0)
Requires-Dist: ollama (>=0.4.4,<0.5.0)
Requires-Dist: openai (>=1.57.0,<2.0.0)
Requires-Dist: pandas (>=2.2.3,<3.0.0)
Requires-Dist: pyaml-env (>=1.2.1,<2.0.0)
Requires-Dist: pyarrow (>=15.0.0,<16.0.0)
Requires-Dist: pydantic (>=2.10.3,<3.0.0)
Requires-Dist: python-dotenv (>=1.0.1,<2.0.0)
Requires-Dist: pyyaml (>=6.0.2,<7.0.0)
Requires-Dist: qianfan (>=0.4.12.1,<0.5.0.0)
Requires-Dist: rich (>=13.9.4,<14.0.0)
Requires-Dist: tenacity (>=8.5.0,<9.0.0)
Requires-Dist: tiktoken (>=0.8.0,<0.9.0)
Requires-Dist: tqdm (>=4.67.1,<5.0.0)
Requires-Dist: typer (>=0.15.1,<0.16.0)
Requires-Dist: typing-extensions (>=4.12.2,<5.0.0)
Requires-Dist: umap-learn (>=0.5.6,<0.6.0)
Project-URL: Repository, https://github.com/guoyao/graphrag-more
Project-URL: Source, https://github.com/guoyao/graphrag-more
Description-Content-Type: text/markdown

# GraphRAG More

åŸºäº [å¾®è½¯GraphRAG](https://github.com/microsoft/graphrag) ï¼Œæ”¯æŒä½¿ç”¨ç™¾åº¦åƒå¸†ã€é˜¿é‡Œé€šä¹‰ã€Ollamaæœ¬åœ°æ¨¡å‹ã€‚

<div align="left">
  <a href="https://pypi.org/project/graphrag-more/">
    <img alt="PyPI - Version" src="https://img.shields.io/pypi/v/graphrag-more">
  </a>
  <a href="https://pypi.org/project/graphrag-more/">
    <img alt="PyPI - Downloads" src="https://img.shields.io/pypi/dm/graphrag-more">
  </a>
</div>

> å¯ä»¥å…ˆç†Ÿæ‚‰ä¸€ä¸‹å¾®è½¯å®˜æ–¹çš„demoæ•™ç¨‹ï¼šğŸ‘‰ [å¾®è½¯å®˜æ–¹æ–‡æ¡£](https://microsoft.github.io/graphrag/get_started/)


## ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

è¦æ±‚ [Python 3.10-3.12](https://www.python.org/downloads/)ï¼Œå»ºè®®ä½¿ç”¨ [pyenv](https://github.com/pyenv) æ¥ç®¡ç†å¤šä¸ªpythonç‰ˆæœ¬

### 1. å®‰è£… graphrag-more
```shell
pip install graphrag-more
```

> å¦‚éœ€äºŒæ¬¡å¼€å‘æˆ–è€…è°ƒè¯•çš„è¯ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨æºç çš„æ–¹å¼ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š
>
> **ä¸‹è½½ graphrag-more ä»£ç åº“**
> ```shell
> git clone https://github.com/guoyao/graphrag-more.git
> ```
>
> **å®‰è£…ä¾èµ–åŒ…**
> è¿™é‡Œä½¿ç”¨ [poetry](https://python-poetry.org) æ¥ç®¡ç†pythonè™šæ‹Ÿç¯å¢ƒ
> ```shell
> # å®‰è£… poetry å‚è€ƒï¼šhttps://python-poetry.org/docs/#installation
>
> cd graphrag-more
> poetry install
> ```

### 2. å‡†å¤‡demoæ•°æ®
```shell
# åˆ›å»ºdemoç›®å½•
mkdir -p ./ragtest/input

# ä¸‹è½½å¾®è½¯å®˜æ–¹demoæ•°æ®
# å¾®è½¯å®˜æ–¹æä¾›çš„demoæ•°æ® https://www.gutenberg.org/cache/epub/24022/pg24022.txt æœ‰ç‚¹å¤§ï¼Œä¼šæ¶ˆè€—ä¸å°‘tokenï¼Œè¿™é‡Œæ”¹ç”¨ç²¾ç®€åçš„æ•°æ®
curl https://raw.githubusercontent.com/guoyao/graphrag-more/refs/heads/main/examples/resources/pg24022.txt > ./ragtest/input/book.txt
```

### 3. åˆå§‹åŒ–demoç›®å½•
```shell
graphrag init --root ./ragtest
```
> å¦‚æœåŸºäºæºç æ–¹å¼ï¼Œè¯·åœ¨æºç æ ¹ç›®å½•ä¸‹ä½¿ç”¨poetryå‘½ä»¤è¿è¡Œï¼š
>
> ```shell
> poetry run poe init --root ./ragtest
> ```

### 4. ç§»åŠ¨å’Œä¿®æ”¹ settings.yaml æ–‡ä»¶
æ ¹æ®é€‰ç”¨çš„æ¨¡å‹ï¼ˆåƒå¸†ã€é€šä¹‰ã€Ollamaï¼‰å’Œä½¿ç”¨çš„`graphrag-more`ç‰ˆæœ¬ï¼ˆä¸åŒç‰ˆæœ¬settings.yamlå¯èƒ½ä¸ä¸€æ ·ï¼‰ï¼Œ
å°† `example_settings` æ–‡ä»¶å¤¹ï¼ˆæ¯”å¦‚ï¼š1.0.0 ç‰ˆæœ¬çš„[example_settings](https://github.com/guoyao/graphrag-more/tree/v1.0.0/example_settings)
ï¼‰å¯¹åº”æ¨¡å‹çš„ settings.yaml æ–‡ä»¶å¤åˆ¶åˆ° ragtest ç›®å½•ï¼Œè¦†ç›–åˆå§‹åŒ–è¿‡ç¨‹ç”Ÿæˆçš„ settings.yaml æ–‡ä»¶ã€‚
```shell
# åƒå¸†
cp ./example_settings/qianfan/settings.yaml ./ragtest

# or é€šä¹‰
cp ./example_settings/tongyi/settings.yaml ./ragtest

# or ollama
cp ./example_settings/ollama/settings.yaml ./ragtest
```
æ¯ä¸ªsettings.yamlé‡Œé¢éƒ½è®¾ç½®äº†é»˜è®¤çš„ llm å’Œ embeddings æ¨¡å‹ï¼Œæ ¹æ®é€‰ç”¨çš„æ¨¡å‹ä¿®æ”¹ settings.yaml æ–‡ä»¶çš„ model é…ç½®
* åƒå¸†é»˜è®¤ä½¿ç”¨ qianfan.ERNIE-Speed-Pro-128K å’Œ qianfan.tao-8k ï¼Œ**æ³¨æ„ï¼šå¿…é¡»å¸¦ä¸Š qianfan. å‰ç¼€ ï¼ï¼ï¼**
* é€šä¹‰é»˜è®¤ä½¿ç”¨ tongyi.qwen-plus å’Œ tongyi.text-embedding-v2 ï¼Œ**æ³¨æ„ï¼šå¿…é¡»å¸¦ä¸Š tongyi. å‰ç¼€ ï¼ï¼ï¼**
* Ollamaé»˜è®¤ä½¿ç”¨ ollama.mistral:latest å’Œ ollama.quentinz/bge-large-zh-v1.5:latest ï¼Œ**æ³¨æ„ï¼š<=0.3.0ç‰ˆæœ¬æ—¶ï¼Œå…¶llmæ¨¡å‹ä¸ç”¨å¸¦å‰ç¼€ï¼Œ>=0.3.1ç‰ˆæœ¬æ—¶ï¼Œå…¶llmæ¨¡å‹å¿…é¡»å¸¦ä¸Š ollama. å‰ç¼€ï¼Œembeddingsæ¨¡å‹å¿…é¡»å¸¦ ollama. å‰ç¼€  ï¼ï¼ï¼**

### 5. æ„å»ºå‰çš„å‡†å¤‡
æ ¹æ®é€‰ç”¨çš„æ¨¡å‹ï¼Œé…ç½®å¯¹åº”çš„ç¯å¢ƒå˜é‡ï¼Œè‹¥ä½¿ç”¨Ollamaéœ€è¦å®‰è£…å¹¶ä¸‹è½½å¯¹åº”æ¨¡å‹
* åƒå¸†ï¼šéœ€é…ç½®ç¯å¢ƒå˜é‡ QIANFAN_AKã€QIANFAN_SKï¼ˆ**æ³¨æ„æ˜¯åº”ç”¨çš„AK/SKï¼Œä¸æ˜¯å®‰å…¨è®¤è¯çš„Access Key/Secret Key**ï¼‰ï¼Œå¦‚ä½•è·å–è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttps://cloud.baidu.com/doc/WENXINWORKSHOP/s/3lmokh7n6#%E6%AD%A5%E9%AA%A4%E4%B8%80%EF%BC%8C%E8%8E%B7%E5%8F%96%E5%BA%94%E7%94%A8%E7%9A%84ak%E5%92%8Csk
* é€šä¹‰ï¼šéœ€é…ç½®ç¯å¢ƒå˜é‡ TONGYI_API_KEYï¼ˆä»0.3.6.1ç‰ˆæœ¬å¼€å§‹ï¼Œä¹Ÿæ”¯æŒä½¿ç”¨ DASHSCOPE_API_KEYï¼ŒåŒæ—¶éƒ½é…ç½®çš„æƒ…å†µä¸‹ TONGYI_API_KEY ä¼˜å…ˆçº§é«˜äº DASHSCOPE_API_KEYï¼‰ï¼Œå¦‚ä½•è·å–è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttps://help.aliyun.com/zh/model-studio/developer-reference/get-api-key
* Ollamaï¼š
  * å®‰è£…ï¼šhttps://ollama.com/download ï¼Œå®‰è£…åå¯åŠ¨
  * ä¸‹è½½æ¨¡å‹
    ```shell
    ollama pull mistral:latest
    ollama pull quentinz/bge-large-zh-v1.5:latest
    ```

### 6. æ„å»ºç´¢å¼•
```shell
graphrag index --root ./ragtest
```
> å¦‚æœåŸºäºæºç æ–¹å¼ï¼Œè¯·åœ¨æºç æ ¹ç›®å½•ä¸‹ä½¿ç”¨poetryå‘½ä»¤è¿è¡Œï¼š
>
> ```shell
> poetry run poe index --root ./ragtest
> ```
æ„å»ºè¿‡ç¨‹å¯èƒ½ä¼šè§¦å‘ rate limit ï¼ˆé™é€Ÿï¼‰å¯¼è‡´æ„å»ºå¤±è´¥ï¼Œé‡å¤æ‰§è¡Œå‡ æ¬¡ï¼Œæˆ–è€…å°è¯•è°ƒå° settings.yaml ä¸­
çš„ requests_per_minute å’Œ concurrent_requests é…ç½®ï¼Œç„¶åé‡è¯•

### 7. æ‰§è¡ŒæŸ¥è¯¢
```shell
# global query
graphrag query \
--root ./ragtest \
--method global \
--query "What are the top themes in this story?"

# local query
graphrag query \
--root ./ragtest \
--method local \
--query "Who is Scrooge, and what are his main relationships?"
```
> å¦‚æœåŸºäºæºç æ–¹å¼ï¼Œè¯·åœ¨æºç æ ¹ç›®å½•ä¸‹ä½¿ç”¨poetryå‘½ä»¤è¿è¡Œï¼š
>
> ```shell
> # global query
> poetry run poe query \
> --root ./ragtest \
> --method global \
> --query "What are the top themes in this story?"
>
> # local query
> poetry run poe query \
> --root ./ragtest \
> --method local \
> --query "Who is Scrooge, and what are his main relationships?"
> ```
æŸ¥è¯¢è¿‡ç¨‹å¯èƒ½ä¼šå‡ºç°jsonè§£ææŠ¥é”™é—®é¢˜ï¼ŒåŸå› æ˜¯æŸäº›æ¨¡å‹æ²¡æŒ‰è¦æ±‚è¾“å‡ºjsonæ ¼å¼ï¼Œå¯ä»¥é‡å¤æ‰§è¡Œå‡ æ¬¡ï¼Œæˆ–è€…ä¿®æ”¹ settings.yaml çš„ llm.model æ”¹ç”¨å…¶ä»–æ¨¡å‹

é™¤äº†ä½¿ç”¨cliå‘½ä»¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨APIæ–¹å¼æ¥æŸ¥è¯¢ï¼Œä»¥ä¾¿é›†æˆåˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ï¼ŒAPIä½¿ç”¨æ–¹å¼è¯·å‚è€ƒï¼š
[examples/api_usage](https://github.com/guoyao/graphrag-more/tree/main/examples/api_usage)ï¼ˆæ³¨æ„ï¼šä¸åŒ`graphrag-more`ç‰ˆæœ¬APIç”¨æ³•å¯èƒ½ä¸ä¸€æ ·ï¼Œå‚è€ƒæ‰€ä½¿ç”¨ç‰ˆæœ¬ä¸‹çš„æ–‡ä»¶ï¼‰
* åŸºäºå·²æœ‰é…ç½®æ–‡ä»¶æŸ¥è¯¢ï¼š[search_by_config_file.py](https://github.com/guoyao/graphrag-more/tree/main/examples/api_usage/search_by_config_file.py)
* åŸºäºä»£ç çš„è‡ªå®šä¹‰æŸ¥è¯¢ï¼š[custom_search.py](https://github.com/guoyao/graphrag-more/tree/main/examples/api_usage/custom_search.py)

