function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./BuilderEmbeddedCodeEditor-xQxb7c_d.js","./index-Bu3rAGYU.js","./index-CHOzhE-F.css","./BuilderEmbeddedCodeEditor-C7Z8O75E.css","./BuilderSettings-CELBtnHV.js","./instancePath-BsbOTTI8.js","./marked.esm-273vDTCT.js","./BuilderSettings-Bq37wndp.css","./BuilderSidebar-BlyWedfy.js","./BuilderSidebar-BWoDgbUr.css","./ComponentRenderer-BW0gEjYv.js","./ComponentRenderer-BsWKHkf0.css","./BuilderInstanceTracker-CnRkjugd.js","./BuilderInstanceTracker-BMktodl2.css","./BuilderInsertionOverlay-CBaSRsBE.js","./BuilderInsertionOverlay-C2m7KHIN.css","./BuilderInsertionLabel-DGC4ZUwa.js","./BuilderInsertionLabel-BQrPp9vH.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as P,i as E,a as x,c as D,r as L,o,e as p,f as e,q as $,x as T,K as g,y as z,z as F,_ as A,L as Ae,b as S,M as u,t as k,m as b,n as I,W as q,D as X,F as K,s as Q,T as re,N as Y,O as te,k as oe,P as de,l as ce,v as De,E as ne,Q as ee,R as Me,S as le,U as Re,w as ie,V as O,J as V,X as He,Y as Ke,A as Oe,Z as Ve,$ as Ue}from"./index-Bu3rAGYU.js";import{marked as ze}from"./marked.esm-273vDTCT.js";const Fe="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='48'%20height='48'%20rx='24'%20fill='black'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M34.0187%2028.9434L37.2255%2015.7128H32.7659L30.812%2015.7128L34.0187%2028.9434Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M25.4266%2015.7128H20.967L25.4266%2034.1126L27.4085%2034.1126H31.8681L27.4085%2015.7128H25.4266L25.4266%2015.7128Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M17.5635%2015.7129H13.1038L13.1039%2015.7132H11.1219L15.5816%2034.113H20.0413L20.0412%2034.1126H22.0231L17.5635%2015.7129Z'%20fill='white'/%3e%3c/svg%3e",se=l=>(z("data-v-3f627d92"),l=l(),F(),l),Ne={class:"BuilderSwitcher"},We=se(()=>e("i",{class:"icon material-symbols-outlined"}," brush ",-1)),je=se(()=>e("i",{class:"icon material-symbols-outlined"}," linked_services ",-1)),qe=se(()=>e("i",{class:"icon material-symbols-outlined"}," preview ",-1)),Ge=P({__name:"BuilderSwitcher",setup(l){const v=E(x.core),s=E(x.builderManager),d=D(()=>v.featureFlags.value.includes("workflows"));let a=L(null);const m=r=>{const i=s.getMode();i!=r&&(a.value=r,s.setMode(r),(r=="preview"||i=="workflows"||r=="workflows")&&s.setSelection(null))},f=D(()=>s.getMode());return(r,i)=>(o(),p("div",Ne,[e("div",{"data-automation-action":"set-mode-ui",class:T({active:f.value=="ui"}),onClick:i[0]||(i[0]=n=>m("ui"))},[We,$(" UI ")],2),d.value?(o(),p("div",{key:0,"data-automation-action":"set-mode-workflows",class:T({active:f.value=="workflows"}),onClick:i[1]||(i[1]=n=>m("workflows"))},[je,$(" Workflows ")],2)):g("",!0),e("div",{class:T({active:f.value=="preview"}),"data-automation-action":"set-mode-preview",onClick:i[2]||(i[2]=n=>m("preview"))},[qe,$(" Preview ")],2)]))}}),Ze=A(Ge,[["__scopeId","data-v-3f627d92"]]),Je=l=>(z("data-v-6d3d54d5"),l=l(),F(),l),Xe={class:"main"},Ye={class:"titleContainer"},Qe={key:0,class:"material-symbols-outlined"},et=Je(()=>e("i",{class:"material-symbols-outlined"},"close",-1)),tt={class:"slotContainer"},ot={key:0,class:"actionContainer"},nt=P({__name:"BuilderModal",props:{modalTitle:{type:String,required:!0},icon:{type:String,required:!1,default:void 0},closeAction:{type:Object,required:!0},menuActions:{type:Array,required:!1,default:void 0},allowOverflow:{type:Boolean,required:!1}},setup(l){const v=l,{modalTitle:s,icon:d,closeAction:a,menuActions:m}=Ae(v),f=r=>{r.key=="Escape"&&a.value.fn()};return(r,i)=>{var n,_;return o(),S(re,{to:"#modal"},[e("div",{class:T(["BuilderModal",{"BuilderModal--overflow":l.allowOverflow}]),tabindex:"-1",onKeydown:f},[e("div",Xe,[e("div",Ye,[u(d)?(o(),p("i",Qe,k(u(d)),1)):g("",!0),e("h2",null,k(u(s)),1),b(q,{variant:"neutral",size:"icon",title:((n=u(a))==null?void 0:n.desc)??"Close",onClick:u(a).fn},{default:I(()=>[et]),_:1},8,["title","onClick"])]),e("div",tt,[X(r.$slots,"default",{},void 0,!0)]),((_=u(m))==null?void 0:_.length)>0?(o(),p("div",ot,[(o(!0),p(K,null,Q(u(m),(h,t)=>(o(),S(q,{key:t,variant:"primary",size:"small",onClick:h.fn},{default:I(()=>[$(k(h.desc),1)]),_:2},1032,["onClick"]))),128))])):g("",!0)])],34)])}}}),ue=A(nt,[["__scopeId","data-v-6d3d54d5"]]),st={class:"BuilderStateExplorer"},at=P({__name:"BuilderStateExplorer",setup(l){const v=E(x.core);return(s,d)=>(o(),p("div",st,[b(Y,{data:u(v).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),lt=A(at,[["__scopeId","data-v-eafb7b97"]]),J=l=>(z("data-v-68ecd636"),l=l(),F(),l),it={class:"BuilderHeader"},rt=J(()=>e("img",{src:Fe,alt:"Writer Framework logo"},null,-1)),dt={class:"undoRedo"},ct=["data-writer-tooltip","disabled"],ut=J(()=>e("i",{class:"material-symbols-outlined"}," undo ",-1)),pt=["data-writer-tooltip","disabled"],_t=J(()=>e("i",{class:"material-symbols-outlined"}," redo ",-1)),vt=J(()=>e("i",{class:"material-symbols-outlined"}," mystery ",-1)),mt=J(()=>e("div",{class:"gap"},null,-1)),ft=["title"],ht={key:0},yt=P({__name:"BuilderHeader",setup(l){const v=L(null),s=E(x.core),d=E(x.builderManager),{undo:a,redo:m,getUndoRedoSnapshot:f}=te(s,d),r=L(!1),i=D(()=>f()),n=()=>{let t="";switch(s.syncHealth.value){case"offline":t+="Offline. Not syncing.";break;case"connected":t+="Online. Syncing...";break;case"idle":t+="Sync not initialised.";break;case"suspended":t+="Sync suspended.";break}return s.featureFlags.value.length>0&&(t+=` Feature flags: ${s.featureFlags.value.join(", ")}`),t};function _(){r.value=!0}const h={desc:"Close",fn:()=>{r.value=!1}};return(t,y)=>(o(),p("div",it,[rt,b(Ze),e("div",dt,[e("button",{class:"undo","data-writer-tooltip":i.value.isUndoAvailable?`Undo: ${i.value.undoDesc}`:"Nothing to undo",disabled:!i.value.isUndoAvailable,"data-writer-tooltip-placement":"bottom",onClick:y[0]||(y[0]=C=>u(a)())},[ut,$(" Undo ")],8,ct),e("button",{class:"redo","data-writer-tooltip":i.value.isRedoAvailable?`Redo: ${i.value.redoDesc}`:"Nothing to redo",disabled:!i.value.isRedoAvailable,"data-writer-tooltip-placement":"bottom",onClick:y[1]||(y[1]=C=>u(m)())},[_t,$(" Redo ")],8,pt)]),e("div",null,[e("button",{onClick:_},[vt,$(" State Explorer ")]),r.value?(o(),S(ue,{key:0,"close-action":h,icon:"mystery","modal-title":"State Explorer"},{default:I(()=>[b(lt)]),_:1})):g("",!0)]),mt,e("div",{class:T(["syncHealth",u(s).syncHealth.value]),title:n()},[e("i",{ref_key:"syncHealthIcon",ref:v,class:"material-symbols-outlined icon"},"sync",512),u(s).syncHealth.value=="offline"?(o(),p("span",ht,"Offline")):g("",!0)],10,ft)]))}}),wt=A(yt,[["__scopeId","data-v-68ecd636"]]),gt={class:"text"},kt=200,bt=4,$t=P({__name:"BuilderTooltip",setup(l){const v=L(null),s=L(!1),d=L(null);let a=null,m=null;const f=L("top"),r=L({top:0,left:0});async function i(){if(!a||(d.value=a.dataset.writerTooltip,!d.value))return;const t=a.dataset.writerTooltipGap?parseInt(a.dataset.writerTooltipGap):bt;s.value=!0,await ee();const{x:y,y:C,width:H,height:N}=a.getBoundingClientRect(),{width:G,height:Z}=v.value.getBoundingClientRect();switch(f.value){case"top":r.value.top=C-Z-t,r.value.left=y+H/2-G/2;break;case"right":r.value.top=C+N/2-Z/2,r.value.left=y+H+t;break;case"left":r.value.left=y-G-t,r.value.top=C+N/2-Z/2;break;case"bottom":r.value.top=C+N+t,r.value.left=y+H/2-G/2;break}}function n(t){const C=t.target.closest("[data-writer-tooltip]");if(C)a!==C&&(s.value=!1);else{s.value=!1,a=null;return}a=C,f.value=a.dataset.writerTooltipPlacement??"top",setTimeout(()=>_(C),kt)}async function _(t){t===a&&(m==null||m.disconnect(),m=new MutationObserver(i),m.observe(a,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement"]}),i())}const h=D(()=>{const{top:t,left:y}=r.value;return{top:`${t}px`,left:`${y}px`}});return oe(()=>{document.documentElement.addEventListener("mouseover",n)}),de(()=>{document.documentElement.removeEventListener("mouseover",n),m==null||m.disconnect()}),(t,y)=>ce((o(),p("div",{ref_key:"rootEl",ref:v,class:"BuilderTooltip",style:ne(h.value)},[e("div",{class:T(["arrow",f.value])},null,2),e("div",gt,k(d.value),1)],4)),[[De,s.value]])}}),Ct=A($t,[["__scopeId","data-v-4457651c"]]),St={class:"BuilderAsyncLoader"},It=P({__name:"BuilderAsyncLoader",setup(l){return(v,s)=>(o(),p("div",St,[b(Me)]))}}),U=A(It,[["__scopeId","data-v-bb820549"]]),Bt={class:"collapser"},Et={class:"material-symbols-outlined"},xt={class:"title"},Lt={class:"titleCompanion"},Tt=["data-order"],Pt={class:"actions"},At={class:"actionsCompanion"},Dt={class:"material-symbols-outlined"},Mt={class:"mainContents"},Rt=P({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{}},setup(l){const v=E(x.builderManager),s=["code","log"],d=l,a=D(()=>!v.openPanels.value.has(d.panelId)),m=D(()=>s.indexOf(d.panelId));function f(n){if(v.openPanels.value.has(n)){v.openPanels.value.delete(n);return}v.openPanels.value.add(n)}function r(n){const _=Re(n);if(_&&n.key==d.keyboardShortcutKey.toLowerCase()){n.preventDefault(),f(d.panelId);return}d.actions.forEach(h=>{if(!h.keyboardShortcut)return;const{key:t,modifierKey:y}=h.keyboardShortcut;t.toLowerCase()==n.key&&(!_&&y||(n.preventDefault(),h.callback()))})}function i(n){if(!n)return"";let _=" (";return n.modifierKey&&(_+=le()),_+=n.key,_+=")",_}return oe(async()=>{document.addEventListener("keydown",r)}),de(()=>{document.removeEventListener("keydown",r)}),(n,_)=>(o(),p("div",{class:T(["BuilderPanel",{collapsed:a.value}])},[e("div",Bt,[b(q,{variant:"neutral",size:"smallIcon","data-automation-action":"toggle-panel","data-automation-key":n.panelId,"data-writer-tooltip":`Toggle ${n.name} (${u(le)()}${n.keyboardShortcutKey})`,onClick:_[0]||(_[0]=h=>f(n.panelId))},{default:I(()=>[e("i",Et,k(a.value?"expand_less":"expand_more"),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),e("div",xt,k(n.name),1),e("div",Lt,[X(n.$slots,"titleCompanion",{},void 0,!0)]),a.value?g("",!0):(o(),S(re,{key:0,to:n.contentsTeleportEl},[e("div",{style:ne({order:m.value}),"data-order":m.value,class:"contents"},[e("div",Pt,[e("div",At,[X(n.$slots,"actionsCompanion",{},void 0,!0)]),(o(!0),p(K,null,Q(n.actions,(h,t)=>(o(),S(q,{key:t,"data-writer-tooltip":h.name+i(h.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:h.isDisabled,onClick:h.callback},{default:I(()=>[e("i",Dt,k(h.icon),1)]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),e("div",Mt,[X(n.$slots,"default",{},void 0,!0)])],12,Tt)],8,["to"]))],2))}}),pe=A(Rt,[["__scopeId","data-v-d7a2ef13"]]),Ht=P({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(l){const v=O({loader:()=>V(()=>import("./BuilderEmbeddedCodeEditor-xQxb7c_d.js").then(_=>_.a),__vite__mapDeps([0,1,2,3]),import.meta.url),loadingComponent:U}),s=E(x.core),d=L(s.runCode.value),a=L(null),m=L(!1),f=D(()=>[{icon:"save",name:"Save and run",keyboardShortcut:{modifierKey:!0,key:"S"},callback:()=>{n()},isDisabled:m.value}]);ie(s.runCode,_=>{d.value=_}),ie(s.sessionTimestamp,()=>{m.value=!1,!i()&&(a.value=null)});function r(){a.value=null}function i(){return s.runCode.value==d.value}async function n(){a.value={type:"neutral",message:"Processing..."};try{m.value=!0,await s.sendCodeSaveRequest(d.value)}catch{a.value={type:"error",message:"Code hasn't been saved."},m.value=!1;return}a.value={type:"success",message:"Saved."}}return(_,h)=>(o(),S(pe,{"panel-id":"code",name:"Code","contents-teleport-el":_.contentsTeleportEl,actions:f.value,scrollable:!1,"keyboard-shortcut-key":"J",class:"BuilderCodePanel"},{actionsCompanion:I(()=>[a.value?(o(),p("div",{key:0,class:T(["status",a.value.type])},k(a.value.message),3)):g("",!0)]),default:I(()=>[b(u(v),{modelValue:d.value,"onUpdate:modelValue":[h[0]||(h[0]=t=>d.value=t),r],variant:"full",language:"python",disabled:m.value},null,8,["modelValue","disabled"])]),_:1},8,["contents-teleport-el","actions"]))}}),Kt=A(Ht,[["__scopeId","data-v-97b8f7a5"]]),M=l=>(z("data-v-92612d54"),l=l(),F(),l),Ot={class:"BuilderLogWorkflowExecution"},Vt=M(()=>e("div",{class:"marker top"},null,-1)),Ut=M(()=>e("div",{class:"marker bottom"},null,-1)),zt={class:"item"},Ft={class:"name"},Nt=M(()=>e("i",{class:"material-symbols-outlined"},"jump_to_element",-1)),Wt={class:"outcome"},jt={class:"result"},qt={class:"detailsModalContent"},Gt=M(()=>e("h2",null,"Result",-1)),Zt=M(()=>e("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),Jt={class:"data","data-automation-key":"result"},Xt={key:1,class:"nothing"},Yt=M(()=>e("h2",null,"Execution environment",-1)),Qt=M(()=>e("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),eo={class:"data"},to={key:1,class:"nothing"},oo=M(()=>e("h2",null,"Return value",-1)),no=M(()=>e("p",null," The value being returned, which is used to determine the result of 'Run workflow' blocks and 'Chat completion' tool calls. ",-1)),so={class:"data","data-automation-key":"return-value"},ao=M(()=>e("i",{class:"material-symbols-outlined"},"find_in_page",-1)),lo={class:"time"},io={key:0,class:"message markdown"},ro=P({__name:"BuilderLogWorkflowExecution",props:{executionLog:{}},setup(l){const v=E(x.core),s=E(x.builderManager),{goToComponentParentPage:d}=te(v,s),a=l,m=L(null),f=D(()=>({summary:[...a.executionLog.summary.map(_=>({..._,component:v.getComponentById(_.componentId),componentDef:v.getComponentById(_.componentId)?v.getComponentDefinition(v.getComponentById(_.componentId).type):void 0}))]}));async function r(n){s.setMode("workflows"),await ee(),d(n),await ee(),s.setSelection(n,void 0,"log")}function i(n){return n<0?"N/A":n<.1?"< 0.1s":`${n.toFixed(2)}s`}return(n,_)=>{const h=He("dompurify-html");return o(),p("div",Ot,[(o(!0),p(K,null,Q(f.value.summary,(t,y)=>{var C,H;return o(),p("div",{key:y,class:"row"},[Vt,Ut,e("div",zt,[e("div",Ft,[$(k(t.componentDef.name)+" ",1),b(q,{variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:N=>r(t.componentId)},{default:I(()=>[Nt]),_:2},1032,["onClick"])]),e("div",Wt,[e("div",{class:T(["ball",(C=t.componentDef.outs[t.outcome])==null?void 0:C.style])},null,2),$(" "+k(((H=t.componentDef.outs[t.outcome])==null?void 0:H.name)??t.outcome),1)]),e("div",jt,[m.value==y?(o(),S(ue,{key:0,"close-action":{desc:"Close",fn:()=>m.value=null},icon:"find_in_page","modal-title":"Details"},{default:I(()=>[e("div",qt,[e("div",null,[Gt,Zt,e("div",Jt,[t!=null&&t.result?(o(),S(Y,{key:0,data:t.result,"initial-depth":1,class:"data"},null,8,["data"])):(o(),p("div",Xt,"No result."))])]),e("div",null,[Yt,Qt,e("div",eo,[t!=null&&t.executionEnvironment?(o(),S(Y,{key:0,data:t.executionEnvironment,"initial-depth":1,class:"data"},null,8,["data"])):(o(),p("div",to," Empty execution environment. "))])]),e("div",null,[oo,no,e("div",so,[t!=null&&t.returnValue?(o(),S(Y,{key:0,data:t.returnValue,"initial-depth":1,class:"data"},null,8,["data"])):(o(),p(K,{key:1},[$(" No return value. ")],64))])])])]),_:2},1032,["close-action"])):g("",!0),t.result||t.returnValue||t.executionEnvironment?(o(),S(q,{key:1,variant:"special",size:"small",onClick:()=>m.value=y},{default:I(()=>[ao,$(" Details ")]),_:2},1032,["onClick"])):g("",!0)]),e("div",lo,k(i(t.executionTimeInSeconds)),1),t.message?ce((o(),p("div",io,null,512)),[[h,u(ze).parse(t.message)]]):g("",!0)])])}),128))])}}}),co=A(ro,[["__scopeId","data-v-92612d54"]]),_e=l=>(z("data-v-34a7a9ff"),l=l(),F(),l),uo={class:"BuilderLogIndicator"},po={key:0,class:"number error"},_o=_e(()=>e("div",{class:"icon"},[e("i",{class:"material-symbols-outlined"},"error")],-1)),vo={key:1,class:"number info"},mo=_e(()=>e("div",{class:"icon"},[e("i",{class:"material-symbols-outlined"},"info")],-1)),fo=P({__name:"BuilderLogIndicator",setup(l){const v=E(x.builderManager),s=D(()=>v.getLogEntries().reduce((d,a)=>(a.type in d||(d[a.type]=0),d[a.type]++,d),{}));return(d,a)=>(o(),p("div",uo,[s.value.error>0?(o(),p("div",po,[_o,$(" "+k(s.value.error??0),1)])):g("",!0),s.value.info>0?(o(),p("div",vo,[mo,$(" "+k(s.value.info??0),1)])):g("",!0)]))}}),ho=A(fo,[["__scopeId","data-v-34a7a9ff"]]),yo=l=>(z("data-v-f784bc20"),l=l(),F(),l),wo={key:0,class:"entries"},go={class:"icon"},ko={key:0,class:"material-symbols-outlined"},bo={key:1,class:"material-symbols-outlined"},$o={class:"title"},Co={class:"time"},So={class:"content"},Io={key:0,class:"codeContainer"},Bo={key:1,class:"emptyMessage"},Eo=yo(()=>e("div",null,[$(" Exceptions and other relevant messages will be shown here."),e("br"),$("Also, you can include print statements in event handlers to create log entries. ")],-1)),xo=[Eo],Lo=P({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(l){const v=E(x.builderManager),s=[{icon:"delete",name:"Clear log",callback:()=>{v.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],d=D(()=>v.getLogEntries());return(a,m)=>(o(),S(pe,{"panel-id":"log",name:"Log","contents-teleport-el":a.contentsTeleportEl,actions:s,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel"},{titleCompanion:I(()=>[b(ho)]),default:I(()=>[d.value.length>0?(o(),p("div",wo,[(o(!0),p(K,null,Q(d.value,(f,r)=>(o(),p(K,{key:r},[e("div",{class:T(["entry",f.type])},[e("div",go,[f.type=="error"?(o(),p("i",ko,"error")):(o(),p("i",bo,"info"))]),e("div",$o,k(f.title)+k(f.repeated>0?` · Repeated ${f.repeated} times`:""),1),e("div",Co,k(f.timestampReceived.toLocaleTimeString()),1),e("div",So,[$(k(f.message)+" ",1),f.code?(o(),p("div",Io,[e("code",null,k(f.code),1)])):g("",!0)])],2),f.workflowExecution?(o(),S(co,{key:0,"execution-log":f.workflowExecution},null,8,["execution-log"])):g("",!0)],64))),128))])):g("",!0),d.value.length==0?(o(),p("div",Bo,xo)):g("",!0)]),_:1},8,["contents-teleport-el"]))}}),To=A(Lo,[["__scopeId","data-v-f784bc20"]]),Po={class:"switches"},Ao=P({__name:"BuilderPanelSwitcher",setup(l){const v=E(x.builderManager),s=L(null);return(d,a)=>(o(),p("div",{class:T(["BuilderPanelSwitcher",{openPanels:u(v).openPanels.value.size>0}])},[e("div",{ref_key:"screenEl",ref:s,class:"screen"},null,512),e("div",Po,[b(Kt,{"contents-teleport-el":s.value},null,8,["contents-teleport-el"]),b(To,{"contents-teleport-el":s.value},null,8,["contents-teleport-el"])])],2))}}),Do=A(Ao,[["__scopeId","data-v-0bc76188"]]),Mo=l=>(z("data-v-bec3fe87"),l=l(),F(),l),Ro={key:0,class:"sidebar"},Ho={class:"builderMain"},Ko={class:"rendererWrapper"},Oo=Mo(()=>e("div",{id:"modal"},null,-1)),Vo=P({__name:"BuilderApp",setup(l){Ke(c=>({f7681972:u(i).getMode()!=="preview"?"var(--builderSidebarWidth)":"0px"}));const v=O({loader:()=>V(()=>import("./BuilderSettings-CELBtnHV.js").then(c=>c.a),__vite__mapDeps([4,1,2,5,0,3,6,7]),import.meta.url),loadingComponent:U}),s=O({loader:()=>V(()=>import("./BuilderSidebar-BlyWedfy.js"),__vite__mapDeps([8,1,2,9]),import.meta.url),loadingComponent:U}),d=O({loader:()=>V(()=>import("./ComponentRenderer-BW0gEjYv.js"),__vite__mapDeps([10,1,2,5,11]),import.meta.url),loadingComponent:U}),a=O({loader:()=>V(()=>import("./BuilderInstanceTracker-CnRkjugd.js"),__vite__mapDeps([12,1,2,13]),import.meta.url),loadingComponent:U}),m=O({loader:()=>V(()=>import("./BuilderInsertionOverlay-CBaSRsBE.js"),__vite__mapDeps([14,1,2,15]),import.meta.url),loadingComponent:U}),f=O({loader:()=>V(()=>import("./BuilderInsertionLabel-DGC4ZUwa.js"),__vite__mapDeps([16,1,2,17]),import.meta.url),loadingComponent:U}),r=E(x.core),i=E(x.builderManager),{candidateId:n,candidateInstancePath:_,isCandidacyConfirmed:h,dropComponent:t,assignInsertionCandidacy:y,removeInsertionCandidacy:C}=Ve(r),{createAndInsertComponent:H,undo:N,redo:G,moveComponent:Z,moveComponentUp:ve,moveComponentDown:me,cutComponent:fe,isPasteAllowed:he,isCopyAllowed:ye,isCutAllowed:we,isDeleteAllowed:ge,isGoToParentAllowed:ke,pasteComponent:be,copyComponent:$e,removeComponentSubtree:Ce,goToParent:Se}=te(r,i),W=D(()=>i.getMode()),Ie=D(()=>{var c;return(c=i.getSelection())==null?void 0:c.componentId});function Be(c){if(c.key=="Escape"){i.setSelection(null);return}const B=Ue()?c.metaKey:c.ctrlKey;if(c.target.closest("textarea, input, select"))return;if(c.key=="z"&&B){c.preventDefault(),N();return}if(c.key=="y"&&B){c.preventDefault(),G();return}if(!i.isSelectionActive())return;const{componentId:w,instancePath:j}=i.getSelection();if(c.key=="Delete"){if(!ge(w))return;Ce(w);return}if(c.key=="ArrowUp"&&B&&c.shiftKey){if(!ke(w))return;Se(w,j);return}if(c.key=="ArrowUp"&&B){ve(w);return}if(c.key=="ArrowDown"&&B){me(w);return}if(c.key=="v"&&B){if(!he(w))return;be(w);return}if(c.key=="c"&&B){if(!ye(w))return;$e(w);return}if(c.key=="x"&&B){if(!we(w))return;fe(w);return}}function Ee(c){W.value!=="preview"&&y(c)}function xe(c){if(W.value==="preview")return;i.setSelection(null);const B=t(c);if(!B)return;const{draggedType:R,draggedId:w,parentId:j,position:ae}=B;w?Z(w,j,ae):H(R,j,ae)}function Le(c){if(W.value==="preview"||c.target.closest("[data-writer-unselectable]"))return;const R=c.target.closest("[data-writer-id]");if(!R)return;const w=R.dataset.writerId,j=R.dataset.writerInstancePath;w!==i.getSelectedId()&&(c.preventDefault(),c.stopPropagation(),i.setSelection(w,j,"click"))}const Te=c=>{if(W.value==="preview")return;const R=c.target.closest("[data-writer-id]").dataset.writerId,{type:w}=r.getComponentById(R);c.dataTransfer.setData(`application/json;writer=${w},${R}`,"{}")};function Pe(c){i.setSelection(null),C(c)}return oe(()=>{document.addEventListener("keydown",Be)}),(c,B)=>(o(),p("div",{class:"BuilderApp",tabindex:"-1",style:ne(u(Oe))},[e("div",{class:T(["mainGrid",{openPanels:u(i).openPanels.value.size>0}])},[b(wt,{class:"builderHeader"}),W.value!=="preview"?(o(),p("div",Ro,[b(u(s))])):g("",!0),e("div",Ho,[e("div",Ko,[b(u(d),{class:T(["componentRenderer",{settingsOpen:u(i).isSelectionActive()}]),onDragover:Ee,onDragstart:Te,onDragend:Pe,onDrop:xe,onClickCapture:Le},null,8,["class"])]),u(i).isSelectionActive()?(o(),S(u(v),{key:Ie.value??"noneSelected"})):g("",!0)]),b(Do,{class:"panelSwitcher"})],2),W.value!=="preview"?(o(),p(K,{key:0},[u(n)&&!u(h)?(o(),p(K,{key:0},[(o(),S(u(a),{key:u(_),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":u(_),"match-size":!0},{default:I(()=>[b(u(m))]),_:1},8,["instance-path"])),(o(),S(u(a),{key:u(_),class:"insertionLabelTracker","instance-path":u(_),"vertical-offset-pixels":-48},{default:I(()=>[b(u(f),null,{default:I(()=>[$(k(u(r).getComponentDefinition(u(r).getComponentById(u(n)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):g("",!0)],64)):g("",!0),Oo,b(Ct,{id:"tooltip"})],4))}}),Uo=A(Vo,[["__scopeId","data-v-bec3fe87"]]),No=Object.freeze(Object.defineProperty({__proto__:null,default:Uo},Symbol.toStringTag,{value:"Module"}));export{ue as B,U as a,No as b};
