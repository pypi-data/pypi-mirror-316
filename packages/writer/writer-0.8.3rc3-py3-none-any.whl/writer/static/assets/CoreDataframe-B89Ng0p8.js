function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-5u5REPT4.js","./serialization-DJC7NP0N.js","./Arrow.dom-GBJpMYQS.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as O,r as y,o as l,e as c,F as G,q as ve,t as N,x as Ae,Q as ne,_ as Z,E as $,b as J,a0 as Ze,f as I,c as f,a1 as Le,a2 as $e,k as _e,P as xe,M as W,s as oe,y as Ee,z as Be,K as X,a3 as ae,a4 as Je,J as M,Y as Ue,i as fe,a as me,w as ee,m as Ce,a5 as Ye,n as Ie,a6 as Qe,l as He,v as Pe,W as qe,a7 as D,a8 as te,a9 as ze,aa as Ke,ab as et,ac as tt,ad as at,ae as nt}from"./index-Bu3rAGYU.js";const ot=["tabindex"],At=["value"],rt=O({__name:"CoreDataframeCellNumber",props:{value:{validator:e=>typeof e=="number"||typeof e=="bigint",required:!0},editable:{type:Boolean,required:!1}},emits:{change:e=>typeof e=="string"},setup(e,{emit:n}){const o=e,s=n,m=y(),A=y(),a=y(!1);async function p(){if(!o.editable)return!1;a.value=!0,await ne(),A.value.focus()}function k(){a.value=!1,Number(A.value.value)!==o.value&&s("change",A.value.value)}return(h,_)=>(l(),c("div",{ref_key:"wrapper",ref:m,class:Ae(["CoreDataframeCellNumber",{"CoreDataframeCellNumber--editable":e.editable}]),tabindex:e.editable&&!a.value?0:-1,onFocusin:p,onClick:p},[a.value?(l(),c("input",{key:0,ref_key:"input",ref:A,type:"number",value:e.value,onFocusout:k},null,40,At)):(l(),c(G,{key:1},[ve(N(e.value),1)],64))],42,ot))}}),st=Z(rt,[["__scopeId","data-v-ce69dacd"]]),lt=["tabindex"],it=["value"],dt=O({__name:"CoreDataframeCellText",props:{value:{validator:()=>!0,required:!0},useMarkdown:{type:Boolean,required:!1},editable:{type:Boolean,required:!1}},emits:{change:e=>typeof e=="string"},setup(e,{emit:n}){const o=e,s=n,m=y(),A=y(),a=y(!1),p=y();async function k(){var _;if(!o.editable)return!1;p.value=((_=m.value)==null?void 0:_.getBoundingClientRect().height)-16-1,a.value=!0,await ne(),A.value.focus()}function h(){a.value=!1,A.value.value!==o.value&&s("change",A.value.value)}return(_,w)=>(l(),c("div",{ref_key:"wrapper",ref:m,class:Ae(["CoreDataframeCellText",{"CoreDataframeCellText--editable":e.editable}]),tabindex:e.editable&&!a.value?0:-1,onFocusin:k,onClick:k},[a.value?(l(),c("textarea",{key:0,ref_key:"textarea",ref:A,value:String(e.value),style:$({height:p.value?`${p.value}px`:"auto"}),onFocusout:h},null,44,it)):(l(),c(G,{key:1},[e.useMarkdown?(l(),J(Ze,{key:0,"raw-text":String(e.value)},null,8,["raw-text"])):(l(),c(G,{key:1},[ve(N(e.value),1)],64))],64))],42,lt))}}),ct=Z(dt,[["__scopeId","data-v-ac09b769"]]),ut=["checked","readonly","tabindex"],ft=O({__name:"CoreDataframeCellBoolean",props:{value:{type:Boolean,required:!0},editable:{type:Boolean,required:!1}},emits:{change:e=>typeof e=="boolean"},setup(e,{emit:n}){const o=e,s=n;function m(A){if(!o.editable){A.preventDefault(),A.stopPropagation();return}s("change",A.target.checked)}return(A,a)=>(l(),c("div",{class:Ae(["CoreDataframeCellBoolean",{"CoreDataframeCellBoolean--disabled":!e.editable}])},[I("input",{type:"checkbox",checked:e.value,readonly:!e.editable,tabindex:e.editable?0:-1,onChange:m},null,40,ut)],2))}}),mt=Z(ft,[["__scopeId","data-v-29cadcfd"]]),vt={class:"CoreDataframeCellUnknown"},pt=O({__name:"CoreDataframeCellUnknown",props:{value:{validator:()=>!0,required:!0}},setup(e){const n=e,o=f(()=>JSON.stringify(n.value,Le));return(s,m)=>(l(),c("div",vt,N(o.value),1))}}),wt=Z(pt,[["__scopeId","data-v-f172f71d"]]),yt=O({__name:"CoreDataframeCell",props:{value:{validator:()=>!0,required:!0},useMarkdown:{type:Boolean,required:!1},editable:{type:Boolean,required:!1}},emits:{change:e=>e!==void 0},setup(e){const n=e,o=f(()=>{switch(typeof n.value){case"number":case"bigint":return st;case"boolean":return mt;case"string":return ct;default:return wt}});return(s,m)=>(l(),J($e(o.value),{value:e.value,"use-markdown":e.useMarkdown,editable:e.editable,onChange:m[0]||(m[0]=A=>s.$emit("change",A))},null,40,["value","use-markdown","editable"]))}}),bt=e=>(Ee("data-v-db6d7db9"),e=e(),Be(),e),ht={class:"BaseDropdown"},gt=["popovertarget"],Ct=bt(()=>I("i",{class:"material-symbols-outlined"},"more_horiz",-1)),It=[Ct],_t=["id"],xt=["onClickCapture"],Et=O({__name:"BaseDropdown",props:{options:{type:Object,required:!0}},emits:{selected:e=>typeof e=="string"},setup(e,{emit:n}){const o=n;function s(){return Math.random().toString()}const m=y(),A=s(),a=y(),p=()=>{var b;return(b=a.value)==null?void 0:b.hidePopover()},k=y("unset"),h=y("unset");function _(){const b=m.value.getBoundingClientRect();k.value=`${b.top+b.height+4+window.pageYOffset}px`,h.value=`${b.left+window.pageXOffset}px`}function w(b){o("selected",b),p()}return _e(()=>window.addEventListener("scroll",p)),xe(()=>window.removeEventListener("scroll",p)),(b,F)=>(l(),c("div",ht,[I("button",{ref_key:"trigger",ref:m,popovertarget:W(A),class:"BaseDropdown__trigger",onClick:_},It,8,gt),I("div",{id:W(A),ref_key:"popover",ref:a,class:"BaseDropdown__dropdown",popover:"",style:$({top:k.value,left:h.value})},[(l(!0),c(G,null,oe(Object.entries(e.options),([i,d])=>(l(),c("button",{key:i,class:"BaseDropdown__dropdown_item",tabindex:"1",onClickCapture:B=>w(i)},N(d),41,xt))),128))],12,_t)]))}}),Bt=Z(Et,[["__scopeId","data-v-db6d7db9"]]),S="__internal_arquero_id",kt="data:application/vnd.apache.arrow.file;base64,QVJST1cxAAD/////iAMAABAAAAAAAAoADgAGAAUACAAKAAAAAAEEABAAAAAAAAoADAAAAAQACAAKAAAAlAIAAAQAAAABAAAADAAAAAgADAAEAAgACAAAAGwCAAAEAAAAXwIAAHsiaW5kZXhfY29sdW1ucyI6IFsiX19pbmRleF9sZXZlbF8wX18iXSwgImNvbHVtbl9pbmRleGVzIjogW3sibmFtZSI6IG51bGwsICJmaWVsZF9uYW1lIjogbnVsbCwgInBhbmRhc190eXBlIjogInVuaWNvZGUiLCAibnVtcHlfdHlwZSI6ICJvYmplY3QiLCAibWV0YWRhdGEiOiB7ImVuY29kaW5nIjogIlVURi04In19XSwgImNvbHVtbnMiOiBbeyJuYW1lIjogImNvbF9hIiwgImZpZWxkX25hbWUiOiAiY29sX2EiLCAicGFuZGFzX3R5cGUiOiAiaW50NjQiLCAibnVtcHlfdHlwZSI6ICJpbnQ2NCIsICJtZXRhZGF0YSI6IG51bGx9LCB7Im5hbWUiOiAiY29sX2IiLCAiZmllbGRfbmFtZSI6ICJjb2xfYiIsICJwYW5kYXNfdHlwZSI6ICJpbnQ2NCIsICJudW1weV90eXBlIjogImludDY0IiwgIm1ldGFkYXRhIjogbnVsbH0sIHsibmFtZSI6IG51bGwsICJmaWVsZF9uYW1lIjogIl9faW5kZXhfbGV2ZWxfMF9fIiwgInBhbmRhc190eXBlIjogImludDY0IiwgIm51bXB5X3R5cGUiOiAiaW50NjQiLCAibWV0YWRhdGEiOiBudWxsfV0sICJjcmVhdG9yIjogeyJsaWJyYXJ5IjogInB5YXJyb3ciLCAidmVyc2lvbiI6ICIxMi4wLjAifSwgInBhbmRhc192ZXJzaW9uIjogIjEuNS4zIn0ABgAAAHBhbmRhcwAAAwAAAIgAAABEAAAABAAAAJT///8AAAECEAAAACQAAAAEAAAAAAAAABEAAABfX2luZGV4X2xldmVsXzBfXwAAAJD///8AAAABQAAAAND///8AAAECEAAAABgAAAAEAAAAAAAAAAUAAABjb2xfYgAAAMD///8AAAABQAAAABAAFAAIAAYABwAMAAAAEAAQAAAAAAABAhAAAAAgAAAABAAAAAAAAAAFAAAAY29sX2EAAAAIAAwACAAHAAgAAAAAAAABQAAAAAAAAAD/////6AAAABQAAAAAAAAADAAWAAYABQAIAAwADAAAAAADBAAYAAAAMAAAAAAAAAAAAAoAGAAMAAQACAAKAAAAfAAAABAAAAACAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAAAAAAAwAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAD/////AAAAABAAAAAMABQABgAIAAwAEAAMAAAAAAAEADwAAAAoAAAABAAAAAEAAACYAwAAAAAAAPAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAACgAMAAAABAAIAAoAAACUAgAABAAAAAEAAAAMAAAACAAMAAQACAAIAAAAbAIAAAQAAABfAgAAeyJpbmRleF9jb2x1bW5zIjogWyJfX2luZGV4X2xldmVsXzBfXyJdLCAiY29sdW1uX2luZGV4ZXMiOiBbeyJuYW1lIjogbnVsbCwgImZpZWxkX25hbWUiOiBudWxsLCAicGFuZGFzX3R5cGUiOiAidW5pY29kZSIsICJudW1weV90eXBlIjogIm9iamVjdCIsICJtZXRhZGF0YSI6IHsiZW5jb2RpbmciOiAiVVRGLTgifX1dLCAiY29sdW1ucyI6IFt7Im5hbWUiOiAiY29sX2EiLCAiZmllbGRfbmFtZSI6ICJjb2xfYSIsICJwYW5kYXNfdHlwZSI6ICJpbnQ2NCIsICJudW1weV90eXBlIjogImludDY0IiwgIm1ldGFkYXRhIjogbnVsbH0sIHsibmFtZSI6ICJjb2xfYiIsICJmaWVsZF9uYW1lIjogImNvbF9iIiwgInBhbmRhc190eXBlIjogImludDY0IiwgIm51bXB5X3R5cGUiOiAiaW50NjQiLCAibWV0YWRhdGEiOiBudWxsfSwgeyJuYW1lIjogbnVsbCwgImZpZWxkX25hbWUiOiAiX19pbmRleF9sZXZlbF8wX18iLCAicGFuZGFzX3R5cGUiOiAiaW50NjQiLCAibnVtcHlfdHlwZSI6ICJpbnQ2NCIsICJtZXRhZGF0YSI6IG51bGx9XSwgImNyZWF0b3IiOiB7ImxpYnJhcnkiOiAicHlhcnJvdyIsICJ2ZXJzaW9uIjogIjEyLjAuMCJ9LCAicGFuZGFzX3ZlcnNpb24iOiAiMS41LjMifQAGAAAAcGFuZGFzAAADAAAAiAAAAEQAAAAEAAAAlP///wAAAQIQAAAAJAAAAAQAAAAAAAAAEQAAAF9faW5kZXhfbGV2ZWxfMF9fAAAAkP///wAAAAFAAAAA0P///wAAAQIQAAAAGAAAAAQAAAAAAAAABQAAAGNvbF9iAAAAwP///wAAAAFAAAAAEAAUAAgABgAHAAwAAAAQABAAAAAAAAECEAAAACAAAAAEAAAAAAAAAAUAAABjb2xfYQAAAAgADAAIAAcACAAAAAAAAAFAAAAAsAMAAEFSUk9XMQ==",ke=/^__index_level_[0-9]+__$/,Rt={key:0,class:"CoreDataframeRow__hand"},Dt={key:1,class:"cell indexCell"},St=O({__name:"CoreDataframeRow",props:{showIndex:{type:Boolean,required:!1},indexText:{type:[Number,String],required:!0},columns:{type:Array,required:!0},row:{type:Object,required:!0},useMarkdown:{type:Boolean,required:!1},editable:{type:Boolean,required:!1},actions:{type:Object,required:!0}},emits:{change:(e,n,o)=>typeof e=="string"&&typeof n=="number"&&o!==void 0,action:(e,n)=>typeof n=="number"&&typeof e=="string"},setup(e){const n=e,o=y(!1),s=f(()=>Object.keys(n.actions||{}).length>0);return(m,A)=>(l(),c("div",{class:"CoreDataframeRow",tabindex:"0",onMouseover:A[1]||(A[1]=a=>o.value=!0),onMouseleave:A[2]||(A[2]=a=>o.value=!1),onFocusin:A[3]||(A[3]=a=>o.value=!0)},[s.value?(l(),c("div",Rt,[o.value?(l(),J(Bt,{key:0,options:e.actions,onSelected:A[0]||(A[0]=a=>m.$emit("action",a,e.row[W(S)]))},null,8,["options"])):X("",!0)])):X("",!0),e.showIndex?(l(),c("div",Dt,N(e.indexText),1)):X("",!0),(l(!0),c(G,null,oe(e.columns,a=>(l(),J(yt,{key:`${e.row[W(S)]}_${a}`,class:"cell",value:e.row[a],"use-markdown":e.useMarkdown,editable:e.editable,onChange:p=>m.$emit("change",a,e.row[W(S)],p)},null,8,["value","use-markdown","editable","onChange"]))),128))],32))}}),Wt=Z(St,[["__scopeId","data-v-0d240511"]]);function Ft(e){const n=ae([]),o=y(!1);async function s(){if(!o.value){for(o.value=!0;n.value.length;){const[A,...a]=n.value;try{await e(A)}catch(p){console.error("Error during handling job",A,p)}finally{n.value=a}}o.value=!1}}function m(A){if(n.value=[...n.value,A],!o.value)return s()}return{push:m,isBusy:Je(o)}}function Tt(e,n,o,s){const m=n.at(-1).componentId,A=f(()=>e.getComponentById(m)),{push:a,isBusy:p}=Ft(k);async function k(i){switch(i.eventType){case"wf-dataframe-add":await h(...i.payload);break;case"wf-dataframe-update":await w(...i.payload);break;case"wf-dataframe-action":await _(...i.payload);break}}async function h(){const i="wf-dataframe-add",d=s.value.numRows(),B=await M(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url),x=B.escape(V=>V[S]===d),g=s.value.filter(x).object();if(!g)throw Error("Could not find record");const T=Vt(g),L=B.from([T]);if(s.value=s.value.concat(L).derive({[S]:()=>B.op.row_number()}),!!b(i))return new Promise(V=>{const U=new CustomEvent(i,{detail:{payload:{record:T,record_index:d},callback:V}});F(U)})}async function _(i,d){const B="wf-dataframe-action";if(!s.value)throw Error("Table is not ready");if(!b(B))return;const x=d-1;return new Promise(g=>{const T=new CustomEvent(B,{detail:{payload:{action:i,record_index:x},callback:g}});F(T)})}async function w(i,d,B){if(!s.value)throw Error("Table is not ready");if(d===void 0)throw Error("Must specify the index to update a row");const x="wf-dataframe-update",g=d-1,T=await M(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url),L=T.escape(j=>j[S]===d),V=s.value.filter(L).object();if(!V)throw Error("Could not find record");const U=V[i],re=jt(U,B),se=T.escape(j=>j[S]===d?re:j[i]);if(s.value=s.value.derive({[i]:se}),!b(x))return;const P=Xt(s.value.filter(L).object());return new Promise(j=>{const le=new CustomEvent(x,{detail:{payload:{record:P,record_index:g},callback:j}});F(le)})}function b(i){var x,g;const d=(x=A.value.handlers)==null?void 0:x[i],B=((g=A.value.binding)==null?void 0:g.eventType)==i;return!!(d||B)}function F(i){o.value instanceof HTMLElement?o.value.dispatchEvent(i):o.value.$el.dispatchEvent(i)}return{isBusy:p,handleUpdateCell:(...i)=>a({eventType:"wf-dataframe-update",payload:i}),handleAddRow:(...i)=>a({eventType:"wf-dataframe-add",payload:i}),handleActionRow:(...i)=>a({eventType:"wf-dataframe-action",payload:i})}}function jt(e,n){switch(typeof e){case"number":return Number(n);case"string":return String(n);case"boolean":return!!n;case"bigint":return BigInt(String(n));default:throw Error(`Could not update a field of type ${typeof e}`)}}function Re(e){return e===S||ke.test(e)}function Xt(e){return Object.entries(e).filter(([n])=>!Re(n)).reduce((n,[o,s])=>(n[o]=s,n),{})}function Vt(e){return Object.entries(e).filter(([n])=>!Re(n)).reduce((n,[o,s])=>(n[o]=Ot(s),n),{})}function Ot(e){switch(typeof e){case"number":return 0;case"string":return"";case"boolean":return!1;case"bigint":return BigInt(0);case"object":return{};default:throw Error(`Could not get default value a field of type ${typeof e}`)}}const H=e=>(Ee("data-v-9687a153"),e=e(),Be(),e),Mt=["aria-busy"],Gt={key:0},Nt=H(()=>I("i",{class:"material-symbols-outlined"},"download",-1)),Zt={key:0},Lt={key:1,"data-writer-grid-col":"0",class:"cell headerCell indexCell"},$t=H(()=>I("div",{class:"name"},null,-1)),Jt=H(()=>I("div",{class:"widthAdjuster"},null,-1)),Ut=[$t,Jt],Yt=["data-writer-grid-col","onClick"],Qt={class:"name"},Ht={class:"icon"},Pt={class:"material-symbols-outlined"},qt=H(()=>I("div",{class:"widthAdjuster"},null,-1)),zt={key:0,class:"CoreDataframe__newRow cell"},Kt=H(()=>I("i",{class:"material-symbols-outlined"},"add",-1)),ea="A component to display Pandas DataFrames.",ta=`
# Subscribe this event handler to the \`wf-dataframe-update\` event
#
# more on : https://dev.writer.com/framework/dataframe
def on_record_change(state, payload):
    state['mydf'].record_update(payload) # should contain an EditableDataFrame instance`,aa=`
# Subscribe this event handler to the \`wf-dataframe-add\` event
#
# more on : https://dev.writer.com/framework/dataframe
def on_record_add(state, payload):
	payload['record']['sales'] = 0 # default value inside the dataframe
	state['mydf'].record_add(payload) # should contain an EditableDataFrame instance`,na=`
# Subscribe this event handler to the \`wf-dataframe-action\` event
#
# more on : https://dev.writer.com/framework/dataframe
def on_record_action(state, payload):
	# state['mydf'] should contains an EditableDataFrame instance
	record_index = payload['record_index']
	if payload['action'] == 'remove':
		state['mydf'].record_remove(payload) # should contain an EditableDataFrame instance
	if payload['action'] == 'open':
		state['record'] = state['mydf'].record(record_index) # dict representation of record`,oa={writer:{name:"DataFrame",description:ea,category:"Content",events:{"wf-dataframe-add":{desc:"Capture adding a row.",stub:aa.trim()},"wf-dataframe-update":{desc:"Capture a cell change.",stub:ta.trim()},"wf-dataframe-action":{desc:"Remove or open a row.",stub:na.trim()}},fields:{dataframe:{name:"Data",desc:"Must be a state reference to a Pandas dataframe or PyArrow table. Alternatively, a URL for an Arrow IPC file.",type:D.Text,default:kt},showIndex:{name:"Show index",desc:"Shows the dataframe's index. If an Arrow table is used, shows the zero-based integer index.",type:D.Text,default:"yes",options:{yes:"yes",no:"no"}},enableSearch:{name:"Enable search",type:D.Text,default:"no",options:{yes:"yes",no:"no"}},enableRecordAdd:{name:"Enable adding a record",type:D.Text,default:"no",options:{yes:"yes",no:"no"}},enableRecordUpdate:{name:"Enable updating a record",type:D.Text,default:"no",options:{yes:"yes",no:"no"}},enableDownload:{name:"Enable download",desc:"Allows the user to download the data as CSV.",type:D.Text,default:"no",options:{yes:"yes",no:"no"}},actions:{name:"Actions",desc:"Define rows actions",type:D.KeyValue,default:JSON.stringify({remove:"Remove",open:"Open"})},useMarkdown:{name:"Use Markdown",type:D.Text,desc:"If active, the output will be sanitized; unsafe elements will be removed.",options:{yes:"yes",no:"no"},default:"no"},displayRowCount:{name:"Display row count",desc:"Specifies how many rows to show simultaneously.",type:D.Number,category:te.Style,default:"10"},wrapText:{name:"Wrap text",type:D.Text,category:te.Style,desc:"Not wrapping text allows for an uniform grid, but may be inconvenient if your data contains longer text fields.",options:{yes:"yes",no:"no"},default:"no"},primaryTextColor:ze,secondaryTextColor:Ke,accentColor:et,separatorColor:tt,dataframeBackgroundColor:{name:"Background",type:D.Color,category:te.Style,default:at.White,applyStyleVariable:!0},fontStyle:{name:"Font style",type:D.Text,category:te.Style,options:{normal:"normal",monospace:"monospace"},default:"normal"},cssClasses:nt}}},Aa=O({...oa,__name:"CoreDataframe",setup(e){Ue(t=>({"01695dcc":q.value?"sticky":"unset"}));const n=1e3,o=36,s=58,m=80,A=300,a=fe(me.evaluatedFields),p=y(),k=y(),h=y();let _=null;const w=ae(null),b=ae([]),F=f(()=>a.showIndex.value=="yes"),i=f(()=>a.actions.value),d=ae(null),B=y(0),x=y([]);let g=null;const T=fe(me.core),L=fe(me.instancePath),{handleUpdateCell:V,handleAddRow:U,handleActionRow:re,isBusy:se}=Tt(T,L,p,w),P=f(()=>ue.value||se.value),j=f(()=>{var t;return w.value?(t=w.value)==null?void 0:t.columnNames():[]}),le=f(()=>j.value.filter(t=>b.value.includes(t))),ie=f(()=>j.value.filter(r=>{if(r===S)return!1;const v=b.value.includes(r),u=ke.test(r);return!(v&&u)})),pe=f(()=>(F.value?1:0)+ie.value.length),Y=f(()=>{var t;return((t=w.value)==null?void 0:t.numRows())??0}),q=f(()=>Y.value>n),Q=f(()=>Math.min(a.displayRowCount.value,Y.value)),we=f(()=>Object.keys(a.actions.value||{}).length>0),De=f(()=>a.useMarkdown.value=="yes"),Se=f(()=>a.enableRecordUpdate.value=="yes"),de=f(()=>a.enableRecordAdd.value=="yes"),z=f(()=>{let t;return a.wrapText.value=="yes"?t=Y.value-1:t=Y.value-Q.value,Math.min(Math.ceil(B.value*t),t)}),ye=f(()=>{if(!w.value)return null;const t=q.value?z.value:0,r=q.value?Q.value:n,v=w.value.objects({offset:t,limit:r}),u=w.value.indices().slice(z.value,z.value+Q.value);return{data:v,indices:u}}),be=f(()=>{let t=we.value?"16px ":"";return x.value.length==0?t+=`repeat(${pe.value}, minmax(min-content, 1fr))`:t+=x.value.map(r=>`${Math.max(r,m)}px`).join(" "),t}),We=f(()=>{const t=a.fontStyle.value;return{"min-height":`${(1+a.displayRowCount.value+Number(de.value??!1))*o}px`,"max-height":`${(Q.value+1+Number(de.value??!1))*o}px`,"font-family":t=="monospace"?"monospace":void 0,"grid-template-rows":`${o}px repeat(${Q.value}, min-content) ${s}px`}}),Fe=f(()=>({top:`${o*Y.value}px`}));function Te(){const t=h.value.scrollTop;B.value=t/(h.value.scrollHeight-h.value.clientHeight)}function je(){h.value.scrollTop=0}async function ce(){var r;x.value=[],await ne();const t=(r=h.value)==null?void 0:r.querySelectorAll("[data-writer-grid-col]");t==null||t.forEach(v=>{const u=v,C=u.dataset.writerGridCol,{width:E}=u.getBoundingClientRect(),R=Math.min(E,A);x.value[C]=R})}function Xe(t,r){var E,R;if(t.target.classList.contains("widthAdjuster"))return;if(((E=d.value)==null?void 0:E.columnName)!==r){d.value={columnName:r,descending:!1};return}if((R=d.value)==null?void 0:R.descending){d.value=null;return}d.value={columnName:r,descending:!d.value.descending}}function Ve(t){const r=t.schema.metadata.get("pandas");return r?JSON.parse(r).index_columns:[]}const ue=y(!1);async function he(){ue.value=!0;const t=await M(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url),{tableFromIPC:r}=await M(()=>import("./Arrow.dom-GBJpMYQS.js"),__vite__mapDeps([2,1]),import.meta.url),v=a.dataframe.value;try{const E=await(await(await fetch(v)).blob()).arrayBuffer(),R=r(E);b.value=Ve(R),_=t.fromArrow(R),w.value=_.derive({[S]:()=>t.op.row_number()})}catch(u){console.error("Couldn't load dataframe from Arrow URL.",u)}finally{ue.value=!1}}async function Oe(){const t=await M(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url),r=w.value.select(t.not(S)).toCSV(),v=document.createElement("a"),u=new Blob([r],{type:"text/csv"}),C=URL.createObjectURL(u);v.href=C,v.download="data.csv",v.click(),URL.revokeObjectURL(C)}async function Me(){const t=await M(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url);if(d.value===null){w.value=w.value.unorder();return}let r;d.value.descending?r=t.desc(d.value.columnName):r=d.value.columnName,w.value=w.value.orderby(r)}async function Ge(t){const r=t.target.value;if(!r)w.value=_;else{const v=new RegExp(r,"i"),C="(d, $) => "+_.columnNames().map(R=>`aq.op.match(d.${R}, $.pattern) !== null`).join(" || "),E=await M(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url);w.value=_.params({pattern:v,filterS:C}).filter(C).derive({[S]:()=>E.op.row_number()})}await ne(),je()}async function ge(t){if(t.buttons!==1){g=null;return}const r=t.target;if(!p.value.contains(r))return;if(g===null&&r.classList.contains("widthAdjuster")){const Ne=r.closest(".cell");g=parseInt(Ne.dataset.writerGridCol)}else if(g===null)return;const v=h.value.querySelector(`[data-writer-grid-col="${g}"]`),u=v.querySelector(".widthAdjuster"),{width:C}=u.getBoundingClientRect(),{left:E}=v.getBoundingClientRect(),K=t.clientX-E+C/2;x.value[g]=K}return ee(a.dataframe,()=>{he()}),ee(d,async()=>{await Me()}),ee(pe,()=>{ce()}),ee(a.wrapText,()=>{ce()}),_e(async()=>{await he(),document.addEventListener("mousemove",ge),k.value&&new ResizeObserver(ce).observe(k.value,{box:"border-box"})}),xe(()=>{document.removeEventListener("mousemove",ge)}),(t,r)=>{var v;return l(),c("div",{ref_key:"rootEl",ref:p,class:"CoreDataframe","aria-busy":P.value},[I("div",{ref_key:"toolsEl",ref:k,class:"tools"},[W(a).enableSearch.value==="yes"?(l(),c("div",Gt,[Ce(Ye,{class:"search",placeholder:"Search","left-icon":"search",onChange:Ge})])):X("",!0),W(a).enableDownload.value==="yes"?(l(),J(Qe,{key:1,title:"Download",class:"download",onClick:Oe},{default:Ie(()=>[Nt]),_:1})):X("",!0)],512),I("div",{ref_key:"gridContainerEl",ref:h,class:"gridContainer",onScroll:Te},[I("div",{class:Ae(["grid",{scrolled:z.value>0,wrapText:W(a).wrapText.value==="yes"}]),style:$(We.value)},[I("div",{style:$({display:"grid","grid-template-columns":be.value})},[we.value?(l(),c("div",Zt)):X("",!0),F.value?(l(),c("div",Lt,Ut)):X("",!0),(l(!0),c(G,null,oe(ie.value,(u,C)=>{var E,R;return l(),c("div",{key:u,"data-writer-grid-col":C+(F.value?1:0),class:"cell headerCell",onClick:K=>Xe(K,u)},[I("div",Qt,N(u),1),He(I("div",Ht,[I("span",Pt,N((E=d.value)!=null&&E.descending?"arrow_upward":"arrow_downward"),1)],512),[[Pe,((R=d.value)==null?void 0:R.columnName)==u]]),qt],8,Yt)}),128))],4),(l(!0),c(G,null,oe((v=ye.value)==null?void 0:v.data,(u,C)=>(l(),J(Wt,{key:C,style:$({"grid-template-columns":be.value}),row:u,actions:i.value,"use-markdown":De.value,editable:Se.value&&!P.value,columns:ie.value,"show-index":F.value,"index-text":ye.value.indices[C]??le.value.map(E=>u[E]).join(", "),onAction:W(re),onChange:W(V)},null,8,["style","row","actions","use-markdown","editable","columns","show-index","index-text","onAction","onChange"]))),128)),de.value?(l(),c("div",zt,[Ce(qe,{"aria-label":"Create a new row at the end",size:"small",variant:"tertiary",onClick:W(U)},{default:Ie(()=>[Kt,ve(" Add a row ")]),_:1},8,["onClick"])])):X("",!0)],6),q.value?(l(),c("div",{key:0,class:"endpoint",style:$(Fe.value)},null,4)):X("",!0)],544)],8,Mt)}}}),sa=Z(Aa,[["__scopeId","data-v-9687a153"]]);export{sa as default};
